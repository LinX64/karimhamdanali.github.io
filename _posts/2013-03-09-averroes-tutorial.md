---
layout: post
title: Analyzing DaCapo and SPEC JVM with averroes - Tutorial
date:   2013-03-09 01:41:00
permalink: /research/averroes-tutorial
group: research
---

This page steps through the process to download and run Averroes to analyze the programs from the 
<a href="http://sourceforge.net/projects/dacapobench/files/archive/2006-10-MR2/" target="_blank">DaCapo-2006-10MR2</a> 
and the <a href="http://www.spec.org/jvm98/" target="_blank">SPEC JVM98</a> benchmarks. I will refer to all these 
programs by the word "benchmarks" throughout the rest of this tutorial.

## Prerequisites ##
You can either:

1. download <a href="{{ "/resources/averroes/tutorial/averroes-home.tar.gz" | prepend: site.baseurl }}">averroes-home.tar.gz</a> 
(the complete archive of files needed for this tutorial) on a machine that runs Java 5.0 or above (both JDK and JRE are 
expected to be installed).
* download <a href="http://www.dropbox.com/s/vbj5ha1s5sx6z6p/ECOOP13.ova" target="_blank">this</a> virtual machine that 
comes with Java pre-installed and contains `averroes-home.tar.gz` on the desktop. Both the user name and the password 
for the administrator account on the virtual machine are "aec", the machine name is "ecoop13".

After the download is complete, extract `averroes-home.tar.gz` to any directory you want.

## Contents of `averroes-home` ##
The directory `averroes-home` should now contain the following artifacts:

* <a href="{{ "/resources/averroes/tutorial/benchmarks/" | prepend: site.baseurl }}" target="_blank">benchmarks/</a>: a directory that contain the JAR files for the benchmarks.
* <a href="{{ "/resources/averroes/tutorial/callgraphs/cgc-call-graphs" | prepend: site.baseurl }}" target="_blank">callgraphs/cgc-call-graphs</a>: a directory that contains the call graphs generated by <a href="{{ "/research/cgc/" | prepend: site.baseurl }}">cgc</a> for the benchmarks.
* <a href="{{ "/resources/averroes/tutorial/callgraphs/doop-averroes-call-graphs" | prepend: site.baseurl }}" target="_blank">callgraphs/doop-averroes-call-graphs</a>: 
a directory that contains the static call graphs generated by Doop<sub>Averroes</sub> (that is Doop using the 
placeholder library generated by Averroes instead of the original library code) for the benchmarks. Running Doop itself 
requires a license for LogicBlox as it depends on it for computing the call graph relations.
* <a href="{{ "/resources/averroes/tutorial/callgraphs/doop-call-graphs" | prepend: site.baseurl }}" target="_blank">callgraphs/doop-call-graphs</a>: 
a directory that contains the static call graphs generated by <a href="http://doop.program-analysis.org" target="_blank">Doop</a> for the benchmarks.
* <a href="{{ "/resources/averroes/tutorial/callgraphs/dynamic-call-graphs" | prepend: site.baseurl }}" target="_blank">callgraphs/dynamic-call-graphs</a>: 
a directory that contains the dynamic call graphs generated by <a href="http://www.sable.mcgill.ca/starj/" target="_blank">*J</a> for the benchmarks.
* <a href="{{ "/resources/averroes/tutorial/callgraphs/spark-call-graphs" | prepend: site.baseurl }}">callgraphs/spark-call-graphs</a>: 
a directory that contains the static call graphs generated by 
<a href="http://www.sable.mcgill.ca/publications/papers/#cc2003-1" target="_blank">Spark</a> from the 
<a href="http://www.sable.mcgill.ca/soot/" target="_blank">Soot</a> framework for the benchmarks.
* <a href="{{ "/resources/averroes/tutorial/jre/rt-1.4.2_11.jar" | prepend: site.baseurl }}">jre/rt-1.4.2_11.jar</a>: 
the default JRE that Averroes uses when generating the placeholder library for any program.
* <a href="{{ "/resources/averroes/tutorial/properties" | prepend: site.baseurl }}">properties/</a>: a directory that 
contains Averroes properties files for the benchmarks. Each file contains the following properties:

Property | Description | Example
:--------|:------------|:-------
*application_includes* | A list of packages and classes that Averroes should treat as application classes, separated by the Java <a href="http://docs.oracle.com/javase/6/docs/api/java/io/File.html#pathSeparator">File.pathSeparator</a> character. Each entry can be one of the following forms:<ul><li>&lt;package&gt;.*: this will include all the classes in this package.</li><li>&lt;package&gt;.**: this will include all the classes in this package and all its sub-packages.</li><li>&lt;class_name&gt;: this will include this class only.</li><li>**: this will include all the classes in the default package.</li></ul> | dacapo.antlr.*:antlr.**



											</tr>
											<tr>
												<td>
												<p class="it">
													main_class
												</p></td>
												<td>
												<p>
													The name of the main class that runs if the input program executes.
												</p></td>
												<td>
												<p>
													dacapo.antlr.Main2
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													input_jar_files
												</p></td>
												<td>
												<p>
													A list of input JAR files separate by the Java <a href="http://docs.oracle.com/javase/6/docs/api/java/io/File.html#pathSeparator">File.pathSeparator</a> character.
												</p></td>
												<td>
												<p>
													dacapo/antlr.jar
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													library_jar_files
												</p></td>
												<td>
												<p>
													A list of library JAR files separate by the Java <a href="http://docs.oracle.com/javase/6/docs/api/java/io/File.html#pathSeparator">File.pathSeparator</a> character.
												</p></td>
												<td>
												<p>
													dacapo/antlr-deps.jar
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													dynamic_classes_file
												</p></td>
												<td>
												<p>
													A file that contains a list of classes that may be dynamically loaded.
												</p></td>
												<td>
												<p>
													dacapo/antlr.dyn
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													tamiflex_facts_file
												</p></td>
												<td>
												<p>
													A file that contains the TamiFlex reflection facts for the input program.
												</p></td>
												<td>
												<p>
													dacapo/antlr.tfx
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													output_dir
												</p></td>
												<td>
												<p>
													The directory to which Averroes outputs its artifacts.
												</p></td>
												<td>
												<p>
													output
												</p></td>
											</tr>
											<tr>
												<td>
												<p class="it">
													jre
												</p></td>
												<td>
												<p>
													The Java runtime environment Averroes should use.
												</p></td>
												<td>
												<p>
													jre/rt-1.4.2_11.jar
												</p></td>
											</tr>
										</tbody>
									</table>
									A sample properties file with more documentation is available <a href="/~karim/resources/averroes/tutorial/properties/averroes.properties.sample">here</a>.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/averroes">averroes</a>: a bash script that runs Averroes against an input benchmark to generate its placeholder library.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/averroes-all">averroes-all</a>: a bash script that runs <a href="/~karim/resources/averroes/tutorial/averroes">averroes</a> over all the benchmarks.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/averroes.jar">averroes.jar</a>: the main runnable JAR for Averroes. This program is the "JAR factory" that will create the placeholder library JAR file for any input program.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/cginfo.jar">cginfo.jar</a>: a utility JAR that prints out call graph information. 
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/spark-averroes">spark-averroes</a>: a bash script that runs Spark<sub>Averroes</sub> against an input benchmark to generate its call graph.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/spark-averroes-all">spark-averroes-all</a>: a bash script that runs <a href="/~karim/resources/averroes/tutorial/spark-averroes">spark-averroes</a> over all the benchmarks.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/spark-averroes.jar">spark-averroes.jar</a>: a runnable JAR for that runs Spark using the placeholder library generated by Averroes instead of the original library code.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/stats">stats</a>: a bash script that generates the statistics of comparing the call graphs generated by Averroes-based tools to the original tools.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/stats-all">stats-all</a>: a bash script that runs <a href="/~karim/resources/averroes/tutorial/stats">stats</a> over all the benchmarks.
								</li>
								<li>
									<a href="/~karim/resources/averroes/tutorial/stats.jar">stats.jar</a>: a runnable JAR for that runs the statistics generator of Averroes for a given benchmark.
								</li>
							</ul>
						</p>